"undefined"==typeof require&&function(e){"use strict";var t,i=0,n=!1,o=!1,a="message".length,r="[iFrameSizer]",s=r.length,c=null,l=e.requestAnimationFrame,f={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},d={},u=null,m={autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,inPageLinks:!1,enablePublicMethods:!0,heightCalculationMethod:"bodyOffset",id:"iFrameResizer",interval:32,log:!1,maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,resizeFrom:"parent",scrolling:!1,sizeHeight:!0,sizeWidth:!1,tolerance:0,widthCalculationMethod:"scroll",closedCallback:function(){},initCallback:function(){},messageCallback:function(){w("MessageCallback function not defined")},resizedCallback:function(){},scrollCallback:function(){return!0}};function g(t,i,n){"addEventListener"in e?t.addEventListener(i,n,!1):"attachEvent"in e&&t.attachEvent("on"+i,n)}function h(t,i,n){"removeEventListener"in e?t.removeEventListener(i,n,!1):"detachEvent"in e&&t.detachEvent("on"+i,n)}function p(t){return r+"["+(n="Host page: "+(i=t),e.top!==e.self&&(n=e.parentIFrame&&e.parentIFrame.getId?e.parentIFrame.getId()+": "+i:"Nested host page: "+i),n)+"]";var i,n}function b(e){return d[e]?d[e].log:n}function y(e,t){k("log",e,t,b(e))}function v(e,t){k("info",e,t,b(e))}function w(e,t){k("warn",e,t,!0)}function k(t,i,n,o){!0===o&&"object"==typeof e.console&&console[t](p(i),n)}function z(t){function i(){n("Height"),n("Width"),O(function(){E(H),M(j)},H,"init")}function n(e){var t=Number(d[j]["max"+e]),i=Number(d[j]["min"+e]),n=e.toLowerCase(),o=Number(H[n]);y(j,"Checking "+n+" is in range "+i+"-"+t),o<i&&(o=i,y(j,"Set "+n+" to min value")),o>t&&(o=t,y(j,"Set "+n+" to max value")),H[n]=""+o}function o(e){return S.substr(S.indexOf(":")+a+e)}function l(t,i){T(function(){var n,o;_("Send Page Info","pageInfo:"+(n=document.body.getBoundingClientRect(),o=H.iframe.getBoundingClientRect(),JSON.stringify({iframeHeight:o.height,iframeWidth:o.width,clientHeight:Math.max(document.documentElement.clientHeight,e.innerHeight||0),clientWidth:Math.max(document.documentElement.clientWidth,e.innerWidth||0),offsetTop:parseInt(o.top-n.top,10),offsetLeft:parseInt(o.left-n.left,10),scrollTop:e.pageYOffset,scrollLeft:e.pageXOffset})),t,i)},32)}function f(e){var t=e.getBoundingClientRect();return F(j),{x:Math.floor(Number(t.left)+Number(c.x)),y:Math.floor(Number(t.top)+Number(c.y))}}function u(t){var i=t?f(H.iframe):{x:0,y:0},n={x:Number(H.width)+i.x,y:Number(H.height)+i.y};y(j,"Reposition requested from iFrame (offset x:"+i.x+" y:"+i.y+")"),e.top!==e.self?e.parentIFrame?e.parentIFrame["scrollTo"+(t?"Offset":"")](n.x,n.y):w(j,"Unable to scroll to requested position, window.parentIFrame not found"):(c=n,m(),y(j,"--"))}function m(){!1!==p("scrollCallback",c)?M(j):R()}function p(e,t){return x(j,e,t)}var b,k,z,N,W,S=t.data,H={},j=null;"[iFrameResizerChild]Ready"===S?function(){for(var e in d)_("iFrame requested init",P(e),document.getElementById(e),e)}():r===(""+S).substr(0,s)&&S.substr(s).split(":")[0]in d?(W=S.substr(s).split(":"),H={iframe:d[W[0]].iframe,id:W[0],height:W[1],width:W[2],type:W[3]},j=H.id,(N=H.type in{true:1,false:1,undefined:1})&&y(j,"Ignoring init message from meta parent page"),!N&&(z=!0,d[k=j]||(z=!1,w(H.type+" No settings for "+k+". Message was: "+S)),z)&&(y(j,"Received: "+S),b=!0,null===H.iframe&&(w(j,"IFrame ("+H.id+") not found"),b=!1),b&&function(){var e,i=t.origin,n=d[j].checkOrigin;if(n&&""+i!="null"&&!(n.constructor===Array?function(){var e=0,t=!1;for(y(j,"Checking connection is from allowed list of origins: "+n);e<n.length;e++)if(n[e]===i){t=!0;break}return t}():(e=d[j].remoteHost,y(j,"Checking connection is from: "+e),i===e)))throw new Error("Unexpected message received from: "+i+" for "+H.iframe.id+". Message was: "+t.data+". This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.");return!0}()&&function(){switch(d[j].firstRun&&(d[j].firstRun=!1),H.type){case"close":I(H.iframe);break;case"message":b=o(6),y(j,"MessageCallback passed: {iframe: "+H.iframe.id+", message: "+b+"}"),p("messageCallback",{iframe:H.iframe,message:JSON.parse(b)}),y(j,"--");break;case"scrollTo":u(!1);break;case"scrollToOffset":u(!0);break;case"pageInfo":l(d[j].iframe,j),function(){function t(t,o){function a(){d[n]?l(d[n].iframe,n):i()}["scroll","resize"].forEach(function(i){y(n,t+i+" listener for sendPageInfo"),o(e,i,a)})}function i(){t("Remove ",h)}var n=j;t("Add ",g),d[n].stopPageInfo=i}();break;case"pageInfoStop":d[j]&&d[j].stopPageInfo&&(d[j].stopPageInfo(),delete d[j].stopPageInfo);break;case"inPageLink":t=o(9),a=t.split("#")[1]||"",r=decodeURIComponent(a),(s=document.getElementById(r)||document.getElementsByName(r)[0])?(n=f(s),y(j,"Moving to in page link (#"+a+") at x: "+n.x+" y: "+n.y),c={x:n.x,y:n.y},m(),y(j,"--")):e.top!==e.self?e.parentIFrame?e.parentIFrame.moveToAnchor(a):y(j,"In page link #"+a+" not found and window.parentIFrame not found"):y(j,"In page link #"+a+" not found");break;case"reset":C(H);break;case"init":i(),p("initCallback",H.iframe),p("resizedCallback",H);break;default:i(),p("resizedCallback",H)}var t,n,a,r,s,b}())):v(j,"Ignored: "+S)}function x(e,t,i){var n=null,o=null;if(d[e]){if("function"!=typeof(n=d[e][t]))throw new TypeError(t+" on iFrame["+e+"] is not a function");o=n(i)}return o}function I(e){var t=e.id;y(t,"Removing iFrame: "+t),e.parentNode.removeChild(e),x(t,"closedCallback",t),y(t,"--"),delete d[t]}function F(t){null===c&&y(t,"Get page position: "+(c={x:void 0!==e.pageXOffset?e.pageXOffset:document.documentElement.scrollLeft,y:void 0!==e.pageYOffset?e.pageYOffset:document.documentElement.scrollTop}).x+","+c.y)}function M(t){null!==c&&(e.scrollTo(c.x,c.y),y(t,"Set page position: "+c.x+","+c.y),R())}function R(){c=null}function C(e){y(e.id,"Size reset requested by "+("init"===e.type?"host page":"iFrame")),F(e.id),O(function(){E(e),_("reset","reset",e.iframe,e.id)},e,"reset")}function E(t){function i(i){o||"0"!==t[i]||(o=!0,y(a,"Hidden iFrame detected, creating visibility listener"),function(){function t(){function e(e){function t(t){return"0px"===d[e].iframe.style[t]}null!==d[e].iframe.offsetParent&&(t("height")||t("width"))&&_("Visibility change","resize",d[e].iframe,e)}for(var t in d)e(t)}function i(e){y("window","Mutation observed: "+e[0].target+" "+e[0].type),T(t,16)}var n=e.MutationObserver||e.WebKitMutationObserver;n&&(o=document.querySelector("body"),new n(i).observe(o,{attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0}));var o}())}function n(e){var n;n=e,t.iframe.style[n]=t[n]+"px",y(t.id,"IFrame ("+a+") "+n+" set to "+t[n]+"px"),i(e)}var a=t.iframe.id;d[a]&&(d[a].sizeHeight&&n("height"),d[a].sizeWidth&&n("width"))}function O(e,t,i){i!==t.type&&l?(y(t.id,"Requesting animation frame"),l(e)):e()}function _(e,t,i,n){var o;n=n||i.id,d[n]&&(i&&"contentWindow"in i&&null!==i.contentWindow?(o=d[n].targetOrigin,y(n,"["+e+"] Sending msg to iframe["+n+"] ("+t+") targetOrigin: "+o),i.contentWindow.postMessage(r+t,o)):(v(n,"["+e+"] IFrame("+n+") not found"),d[n]&&delete d[n]))}function P(e){return e+":"+d[e].bodyMarginV1+":"+d[e].sizeWidth+":"+d[e].log+":"+d[e].interval+":"+d[e].enablePublicMethods+":"+d[e].autoResize+":"+d[e].bodyMargin+":"+d[e].heightCalculationMethod+":"+d[e].bodyBackground+":"+d[e].bodyPadding+":"+d[e].tolerance+":"+d[e].inPageLinks+":"+d[e].resizeFrom+":"+d[e].widthCalculationMethod}function N(e,t){var o,a,r,s,c,l=(o=e.id,o,""===o&&(e.id=(a=t&&t.id||m.id+i++,null!==document.getElementById(a)&&(a+=i++),o=a),n=(t||{}).log,o,y(o,"Added missing iframe ID: "+o+" ("+e.src+")")),o);l in d&&"iFrameResizer"in e?w(l,"Ignored iFrame, already setup."):(s=(s=t)||{},d[l]={firstRun:!0,iframe:e,remoteHost:e.src.split("/").slice(0,3).join("/")},function(e){if("object"!=typeof e)throw new TypeError("Options is not an object")}(s),function(e){for(var t in m)m.hasOwnProperty(t)&&(d[l][t]=e.hasOwnProperty(t)?e[t]:m[t])}(s),d[l].targetOrigin=!0===d[l].checkOrigin?""===(c=d[l].remoteHost)||"file://"===c?"*":c:"*",y(l,"IFrame scrolling "+(d[l].scrolling?"enabled":"disabled")+" for "+l),e.style.overflow=!1===d[l].scrolling?"hidden":"auto",e.scrolling=!1===d[l].scrolling?"no":"yes",function(){function t(t){1/0!==d[l][t]&&0!==d[l][t]&&(e.style[t]=d[l][t]+"px",y(l,"Set "+t+" = "+d[l][t]+"px"))}function i(e){if(d[l]["min"+e]>d[l]["max"+e])throw new Error("Value for min"+e+" can not be greater than max"+e)}i("Height"),i("Width"),t("maxHeight"),t("minHeight"),t("maxWidth"),t("minWidth")}(),"number"!=typeof d[l].bodyMargin&&"0"!==d[l].bodyMargin||(d[l].bodyMarginV1=d[l].bodyMargin,d[l].bodyMargin=d[l].bodyMargin+"px"),r=P(l),g(e,"load",function(){var t,i;_("iFrame.onload",r,e),t=d[l].firstRun,i=d[l].heightCalculationMethod in f,!t&&i&&C({iframe:e,height:0,width:0,type:"init"})}),_("init",r,e),Function.prototype.bind&&(d[l].iframe.iFrameResizer={close:I.bind(null,d[l].iframe),resize:_.bind(null,"Window resize","resize",d[l].iframe),moveToAnchor:function(e){_("Move to anchor","moveToAnchor:"+e,d[l].iframe,l)},sendMessage:function(e){_("Send Message","message:"+(e=JSON.stringify(e)),d[l].iframe,l)}}))}function T(e,t){null===u&&(u=setTimeout(function(){u=null,e()},t))}function W(e){y("window","Trigger event: "+e),T(function(){H("Window "+e,"resize")},16)}function S(){"hidden"!==document.visibilityState&&(y("document","Trigger event: Visiblity change"),T(function(){H("Tab Visable","resize")},16))}function H(e,t){for(var i in d)"parent"===d[n=i].resizeFrom&&d[n].autoResize&&!d[n].firstRun&&_(e,t,document.getElementById(i),i);var n}function j(){function t(e,t){t&&(!function(){if(!t.tagName)throw new TypeError("Object is not a valid DOM element");if("IFRAME"!==t.tagName.toUpperCase())throw new TypeError("Expected <IFRAME> tag, found <"+t.tagName+">")}(),N(t,e),i.push(t))}var i;return function(){var t,i=["moz","webkit","o","ms"];for(t=0;t<i.length&&!l;t+=1)l=e[i[t]+"RequestAnimationFrame"];l||y("setup","RequestAnimationFrame not supported")}(),g(e,"message",z),g(e,"resize",function(){W("resize")}),g(document,"visibilitychange",S),g(document,"-webkit-visibilitychange",S),g(e,"focusin",function(){W("focus")}),g(e,"focus",function(){W("focus")}),function(e,n){switch(i=[],typeof n){case"undefined":case"string":Array.prototype.forEach.call(document.querySelectorAll(n||"iframe"),t.bind(void 0,e));break;case"object":t(e,n);break;default:throw new TypeError("Unexpected data type ("+typeof n+")")}return i}}e.jQuery&&((t=jQuery).fn?t.fn.iFrameResize=function(e){return this.filter("iframe").each(function(t,i){N(i,e)}).end()}:v("","Unable to bind to jQuery, it is not fully loaded.")),"function"==typeof define&&define.amd?define([],j):"object"==typeof module&&"object"==typeof module.exports?module.exports=j():e.iFrameResize=e.iFrameResize||j()}(window||{});var initiating_bypass_chat=!1,iframeOptions={checkOrigin:0,inPageLinks:!0,autoResize:!0,sizeWidth:!0,resizedCallback:function(e){if(e.height<150&&e.height>60&&settings&&"chaticon"==settings.visitor_widget_type){var t=0;"yes"==settings.enable_online_animation&&(t=30),e.width=82+t,"chaticon"==settings.visitor_widget_type&&("medium-size"==settings.chat_icon_size?e.width=62+t:"small-size"==settings.chat_icon_size&&(e.width=49+t))}if(e.height<190&&e.height>150?initiating_bypass_chat=!0:e.height>200&&(initiating_bypass_chat=!1),settings){var i="chat-cmodule-iframe";is_mobile||(i="chat-cmodule-iframe iframe-pull-"+settings.window_position),"chaticon"==settings.visitor_widget_type?i+=" chat-cmodule-"+settings.chat_icon_size:"chatbar"==settings.visitor_widget_type&&(e.width=354,i+=" chat-cmodule-widget-bar"),document.getElementById("chatbull-frame").className=i}initiating_bypass_chat&&(e.width=354),document.getElementById("chatbull-frame").style.width=e.width+"px"},initCallback:function(e){},messageCallback:function(e){},closedCallback:function(e){var t=cburl+"index.php?d=visitors&c=chatbox&m=index&token="+access_token;"undefined"!=typeof cbuser&&(t+="&"+buildQueryParam(cbuser)),t+="&"+buildQueryParam(cbwindow),t+="&page_title="+encodeURIComponent(ptitle),t+="&page_url="+encodeURIComponent(purl),window.location=t}};if("undefined"!=typeof require){var iFrameResizerPath=cburl+"assets/cmodule-chat/js/iframeResizer.min.js";require([iFrameResizerPath],function(e){e(iframeOptions)})}else iFrameResize(iframeOptions);